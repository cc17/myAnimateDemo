<!DOCTYPE>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>简单的下雪例子效果</title>

<!--记得引用jquery框架-->
<script src="src/js/lib/jquery-2.0.2.js"></script>

</head>
<body style="background:url(src/img/bk.jpg) no-repeat;background-size:cover;">
	<img src="http://ie.microsoft.com/testdrive/Performance/LetItSnow/res/Snowflakes.png" id="J-img" style="display:none">
<canvas id="canvas" width="1680" height="680">
</canvas>
<script type="text/javascript">
$(document).ready(function(e) {
    var canvas=document.getElementById("canvas");//获取画布
    var c = canvas.getContext('2d');


        var particles=[];//存放雪花
        var tick=0;//计数
        function loop()
    {
                //创建雪花
                createParticles();
                //更新雪5
                grow();
                //移除雪花
                die();
                //绘制雪花
                drawParticles();        
    }
        //创建雪花
    function createParticles() {
    if(tick % 10 == 0) {
        if(particles.length <60) {
            particles.push({
                    x: Math.random()*canvas.width,//在canvas宽度内随机出现
                    y: 0,
                    speed: 1+Math.random()*7, //between 1 and 3
                    radius: 1+Math.random()*5, //between 1 and 5
                    color: "white",
            });
        }
    }
}
//更新雪花
function grow() {
    for(var i in particles) {
        var part = particles[i];
        part.y += part.speed;
        if(part.y > canvas.height){
        	//die(i);
        }
    }
}
//移除雪花
function die(index) {
	//particles.splice(index,i);
    for(var i in particles) {
        var part = particles[i];
        if(part.y > canvas.height) {
            part.y = 0;
            particles.splice(i,1);
        }
    }
}
//绘制雪花
function drawParticles() {
    c.clearRect(0,0,canvas.width,canvas.height);
    //c.fillStyle ="#ccc";
    //c.fillRect(0,0,canvas.width,canvas.height);
    for(var i in particles) {
        var part = particles[i];


        c.drawImage(document.getElementById('J-img'), part.x, part.y,15,15);

     


        // c.beginPath();
        // c.arc(part.x,part.y, part.radius, 0, Math.PI*2);
        // c.closePath();
        // c.fillStyle = part.color;
        // c.fill();
    }
}
        setInterval(loop,30);
});
</script>
</body>
</html>