<html>
<head>
	<title></title>
</head>
<body style="background:#000">
	<canvas id="canvas" width="1600" height="500"></canvas>
	<script type="text/javascript">
		var Snowflow = function(){
			this.canvas = document.getElementsByTagName('canvas')[0];
			this.ctx = this.canvas.getContext('2d');
			this.w = this.canvas.width;
			this.h = this.canvas.height;
			this.particles = [];
			this.dt = 20;
			this.init();
		};
		Snowflow.prototype = {
			constructor:Snowflow,
			init:function(){
				var me = this;
				var count = 0;
				var loop = function(){
					if(count % 10 == 0){
						if(me.particles.length < 40){
							me.add();
							me.grow();
							me.draw();
						}
					}
					count ++;
					requestAnimationFrame(loop);
				};
				loop();
			},
			add:function(){
				var me = this;
				var particle = {
					position: {x :Math.random() * me.w, y:0},
					life:1,
					radius:5,
					age:0,
					velocity: Math.random * 10
				};
				this.particles.push(particle);
			},
			grow:function(){
				for(var i =0,len = this.particles.length;i<len;i++){
					var p = this.particles[i];
					p.position.y += this.dt;
					p.age += 0.038;
					if(p.position.y >= this.h){
						this.particles.splice(i,1);
						len = this.particles.length;
					}
				}
			},
			draw:function(){
				var ctx = this.ctx;
				ctx.clearRect(0,0,this.w,this.h);
				for(var i =0,len = this.particles.length;i<len;i++){
					var p = this.particles[i];
					var alpha = 1 - p.age / p.life;
					ctx.fillStyle = 'rgba(255,255,255,'+ alpha.toFixed(2) +')';
					ctx.beginPath();
					//console.log(p.position.y);
					ctx.arc(p.position.x,p.position.y,p.radius,0,Math.PI*2,true);
					ctx.closePath();
					ctx.fill();
				}
			}

		};
		new Snowflow();


	</script>
</body>
</html>